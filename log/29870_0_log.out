submitit INFO (2025-03-08 07:55:39,133) - Starting with JobEnvironment(job_id=29870, hostname=05fdf3d7af0d, local_rank=0(1), node=0(1), global_rank=0(1))
submitit INFO (2025-03-08 07:55:39,135) - Loading pickle: /content/drive/MyDrive/emg2qwerty-main/logs/2025-03-08/07-55-38/submitit_logs/29870/29870_submitted.pkl
[2025-03-08 07:55:49,120][__main__][INFO] - 
Config:
user: single_user
dataset:
  train:
  - user: 89335547
    session: 2021-06-03-1622765527-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-02-1622681518-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-04-1622863166-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  val:
  - user: 89335547
    session: 2021-06-04-1622862148-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  test:
  - user: 89335547
    session: 2021-06-02-1622682789-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  root: ${hydra:runtime.cwd}/data
to_tensor:
  _target_: emg2qwerty.transforms.ToTensor
  fields:
  - emg_left
  - emg_right
band_rotation:
  _target_: emg2qwerty.transforms.ForEach
  transform:
    _target_: emg2qwerty.transforms.RandomBandRotation
    offsets:
    - -1
    - 0
    - 1
temporal_jitter:
  _target_: emg2qwerty.transforms.TemporalAlignmentJitter
  max_offset: 120
logspec:
  _target_: emg2qwerty.transforms.LogSpectrogram
  n_fft: 64
  hop_length: 16
specaug:
  _target_: emg2qwerty.transforms.SpecAugment
  n_time_masks: 3
  time_mask_param: 25
  n_freq_masks: 2
  freq_mask_param: 4
transforms:
  train:
  - ${to_tensor}
  - ${band_rotation}
  - ${temporal_jitter}
  - ${logspec}
  - ${specaug}
  val:
  - ${to_tensor}
  - ${logspec}
  test: ${transforms.val}
module:
  _target_: emg2qwerty.lightning.TDSConvCTCModule
  in_features: 528
  mlp_features:
  - 192
  block_channels:
  - 12
  - 12
  - 12
  - 12
  kernel_width: 32
datamodule:
  _target_: emg2qwerty.lightning.WindowedEMGDataModule
  window_length: 8000
  padding:
  - 1800
  - 200
optimizer:
  _target_: torch.optim.Adam
  lr: 0.001
lr_scheduler:
  scheduler:
    _target_: pl_bolts.optimizers.lr_scheduler.LinearWarmupCosineAnnealingLR
    warmup_epochs: 10
    max_epochs: ${trainer.max_epochs}
    warmup_start_lr: 1.0e-08
    eta_min: 1.0e-06
  interval: epoch
decoder:
  _target_: emg2qwerty.decoder.CTCGreedyDecoder
seed: 1501
batch_size: 8
num_workers: 4
train: false
checkpoint: /content/drive/MyDrive/emg2qwerty-main/logs/2025-03-08/06-39-00/job0_trainer.devices=1,user=single_user/checkpoints/epoch=1-step=184.ckpt
monitor_metric: val/CER
monitor_mode: min
trainer:
  accelerator: cpu
  devices: 1
  num_nodes: 1
  max_epochs: 20
  default_root_dir: ${hydra:runtime.output_dir}
callbacks:
- _target_: pytorch_lightning.callbacks.LearningRateMonitor
- _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: ${hydra:runtime.output_dir}/checkpoints
  monitor: ${monitor_metric}
  mode: ${monitor_mode}
  save_last: true
  verbose: true

[2025-03-08 07:55:49,141][__main__][INFO] - Instantiating LightningModule {'_target_': 'emg2qwerty.lightning.TDSConvCTCModule', 'in_features': 528, 'mlp_features': [192], 'block_channels': [12, 12, 12, 12], 'kernel_width': 32}
[2025-03-08 07:55:49,227][__main__][INFO] - Loading module from checkpoint /content/drive/MyDrive/emg2qwerty-main/logs/2025-03-08/06-39-00/job0_trainer.devices=1,user=single_user/checkpoints/epoch=1-step=184.ckpt
[2025-03-08 07:55:49,407][__main__][INFO] - Instantiating LightningDataModule {'_target_': 'emg2qwerty.lightning.WindowedEMGDataModule', 'window_length': 8000, 'padding': [1800, 200]}

Validation: 0it [00:00, ?it/s]
Validation:   0%|          | 0/27 [00:00<?, ?it/s]
Validation DataLoader 0:   0%|          | 0/27 [00:00<?, ?it/s]
Validation DataLoader 0:   4%|▎         | 1/27 [00:00<00:25,  1.02it/s]
Validation DataLoader 0:   7%|▋         | 2/27 [00:01<00:20,  1.22it/s]
Validation DataLoader 0:  11%|█         | 3/27 [00:02<00:18,  1.30it/s]
Validation DataLoader 0:  15%|█▍        | 4/27 [00:02<00:17,  1.35it/s]
Validation DataLoader 0:  19%|█▊        | 5/27 [00:03<00:15,  1.39it/s]
Validation DataLoader 0:  22%|██▏       | 6/27 [00:04<00:14,  1.42it/s]
Validation DataLoader 0:  26%|██▌       | 7/27 [00:04<00:14,  1.42it/s]
Validation DataLoader 0:  30%|██▉       | 8/27 [00:05<00:13,  1.41it/s]
Validation DataLoader 0:  33%|███▎      | 9/27 [00:06<00:12,  1.43it/s]
Validation DataLoader 0:  37%|███▋      | 10/27 [00:06<00:11,  1.44it/s]
Validation DataLoader 0:  41%|████      | 11/27 [00:07<00:11,  1.43it/s]
Validation DataLoader 0:  44%|████▍     | 12/27 [00:08<00:10,  1.42it/s]
Validation DataLoader 0:  48%|████▊     | 13/27 [00:09<00:10,  1.38it/s]
Validation DataLoader 0:  52%|█████▏    | 14/27 [00:10<00:09,  1.39it/s]
Validation DataLoader 0:  56%|█████▌    | 15/27 [00:10<00:08,  1.40it/s]
Validation DataLoader 0:  59%|█████▉    | 16/27 [00:11<00:07,  1.41it/s]
Validation DataLoader 0:  63%|██████▎   | 17/27 [00:11<00:07,  1.42it/s]
Validation DataLoader 0:  67%|██████▋   | 18/27 [00:12<00:06,  1.43it/s]
Validation DataLoader 0:  70%|███████   | 19/27 [00:13<00:05,  1.44it/s]
Validation DataLoader 0:  74%|███████▍  | 20/27 [00:13<00:04,  1.45it/s]
Validation DataLoader 0:  78%|███████▊  | 21/27 [00:14<00:04,  1.46it/s]
Validation DataLoader 0:  81%|████████▏ | 22/27 [00:15<00:03,  1.46it/s]
Validation DataLoader 0:  85%|████████▌ | 23/27 [00:15<00:02,  1.46it/s]
Validation DataLoader 0:  89%|████████▉ | 24/27 [00:16<00:02,  1.47it/s]
Validation DataLoader 0:  93%|█████████▎| 25/27 [00:16<00:01,  1.48it/s]
Validation DataLoader 0:  96%|█████████▋| 26/27 [00:17<00:00,  1.49it/s]
Validation DataLoader 0: 100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Validation DataLoader 0: 100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃  Runningstage.validating  ┃                           ┃
┃          metric           ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│          val/CER          │           100.0           │
│          val/DER          │            0.0            │
│          val/IER          │           100.0           │
│          val/SER          │            0.0            │
│         val/loss          │     4.961470603942871     │
└───────────────────────────┴───────────────────────────┘

Testing: 0it [00:00, ?it/s]
Testing:   0%|          | 0/1 [00:00<?, ?it/s]
Testing DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Testing DataLoader 0: 100%|██████████| 1/1 [01:09<00:00, 69.38s/it]
Testing DataLoader 0: 100%|██████████| 1/1 [01:09<00:00, 69.47s/it]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃   Runningstage.testing    ┃                           ┃
┃          metric           ┃       DataLoader 0        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│         test/CER          │           100.0           │
│         test/DER          │            0.0            │
│         test/IER          │           100.0           │
│         test/SER          │            0.0            │
│         test/loss         │     4.701166152954102     │
└───────────────────────────┴───────────────────────────┘
{'val_metrics': [{'val/loss': 4.961470603942871,
                  'val/CER': 100.0,
                  'val/IER': 100.0,
                  'val/DER': 0.0,
                  'val/SER': 0.0}],
 'test_metrics': [{'test/loss': 4.701166152954102,
                   'test/CER': 100.0,
                   'test/IER': 100.0,
                   'test/DER': 0.0,
                   'test/SER': 0.0}],
 'best_checkpoint': ''}
submitit INFO (2025-03-08 07:57:24,852) - Job completed successfully
[2025-03-08 07:57:24,852][submitit][INFO] - Job completed successfully
submitit INFO (2025-03-08 07:57:24,865) - Exiting after successful completion
[2025-03-08 07:57:24,865][submitit][INFO] - Exiting after successful completion
